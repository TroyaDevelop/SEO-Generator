# Для бота: только нужные запросы


# Для бота: только нужные запросы

## 1. Получить список заказов, которые нужно сгенерировать
- GET-запрос на `/tasks`
- В ответе будет массив заказов, где pay = 1 и text = null (оплаченные, но ещё не сгенерированные)

Пример ответа:
[
  {
    "id": 5,
    "token": "...",
    "keyword": "пример",
    "pay": 1,
    "text": null
  },
  ...
]

## 2. Вернуть сгенерированный текст для заказа
- POST-запрос на `/tasks/ID/complete` (ID — номер заказа)
- В теле запроса:
  {
    "text": "сюда вставьте текст, который сгенерировал бот"
  }
- В ответе — обновлённый объект заказа

Этих двух запросов достаточно для работы бота: взять заказ и отправить текст.

Адрес сайта: http://5.129.253.226:3000


# Для бота: семантические задачи

## 1. Получить список задач, которые нужно сгенерировать
+- GET-запрос на `/tasks/semantic-tasks`
+- В ответе будет массив задач, где `keywords` = null (ещё не сгенерированные)

Пример ответа:
[
  {
    "id": 12,
    "mainKeyword": "пример",
    "keywords": null,
    "createdAt": "2025-09-29T12:00:00.000Z"
  },
  ...
]

## 2. Вернуть сгенерированные ключевые слова для задачи
- POST-запрос на `/tasks/semantic-tasks/ID/complete` (ID — номер задачи)
- В теле запроса:
  {
    "keywords": ["ключевое1", "ключевое2", ...]
  }
- В ответе — обновлённый объект задачи

Этих двух запросов достаточно для работы бота: взять задачу и отправить ключевые слова.

Адрес сайта: http://5.129.253.226:3000


### Важная заметка — защита токеном отключена
В этой сборке проверки заголовка `x-bot-token` для бот-эндпоинтов отключены (см. `server/utils/botAuth.js`).
Если вы хотите снова включить защиту:

1) Установите переменную окружения на сервере:

```bash
export BOT_TOKEN="строка_токена"
```

2) В `server/utils/botAuth.js` раскомментируйте оригинальную проверку токена (в файле оставлен закомментированный фрагмент) и перезапустите сервер.

Примеры curl (текущая конфигурация — без обязательного заголовка):

GET задачи:

```bash
curl -sS http://5.129.253.226:3000/tasks/semantic-tasks | jq
```

POST результат:

```bash
curl -X POST http://5.129.253.226:3000/tasks/semantic-tasks/12/complete \
  -H "Content-Type: application/json" \
  -d '{"keywords":["ключ1","ключ2"]}' | jq
```
